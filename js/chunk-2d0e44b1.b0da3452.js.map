{"version":3,"sources":["webpack:///./src/components/content/Tree/Tree/b-tree-item.vue?bd22","webpack:///src/components/content/Tree/Tree/b-tree-item.vue","webpack:///./src/components/content/Tree/Tree/b-tree-item.vue?27e0","webpack:///./src/components/content/Tree/Tree/b-tree-item.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","staticClass","class","objClass","attrs","on","mouseenterOnItem","mouseleaveOnItem","$event","stopPropagation","clickOnItem","apply","arguments","dblclickOnItem","dragstart","preventDefault","dragover","dragleave","dragend","dragexit","drop","itemClass","open","icon","caretDown","caretRight","staticStyle","folderOpen","folder","fileAlt","editItem","item","value","editorBlur","_v","_s","directives","name","rawName","expression","status","children","primaryKey","model","callback","$$v","selectedOption","_e","staticRenderFns","components","props","util","Number","type","String","default","require","selected","data","hover","editError","dropStatus","computed","config","isFolder","canEdit","disabled","isSelected","watch","$emit","methods","editValid","editInvalid","hideEditor","event","target","style","opacity","dataTransfer","setData","$store","state","timer","commit","tools","cellback","currentTarget","component"],"mappings":"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","file":"js/chunk-2d0e44b1.b0da3452.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{ref:\"dropzone\",staticClass:\"d-table-row d-flex align-items-center\",class:_vm.objClass,attrs:{\"draggable\":\"true\"},on:{\"mouseenter\":_vm.mouseenterOnItem,\"mouseleave\":_vm.mouseleaveOnItem,\"click\":function($event){$event.stopPropagation();return _vm.clickOnItem.apply(null, arguments)},\"dblclick\":function($event){$event.stopPropagation();return _vm.dblclickOnItem.apply(null, arguments)},\"dragstart\":_vm.dragstart,\"dragover\":function($event){$event.preventDefault();return _vm.dragover.apply(null, arguments)},\"dragleave\":_vm.dragleave,\"dragend\":_vm.dragend,\"dragexit\":_vm.dragexit,\"drop\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.drop.apply(null, arguments)}}},[_c('div',{staticClass:\"d-table-cell ps-1\",class:_vm.itemClass,on:{\"click\":function($event){$event.stopPropagation();_vm.open = !_vm.open}}},[(_vm.isFolder)?_c('div',[_c('i',{staticClass:\"me-2\",class:_vm.open ? _vm.icon.caretDown : _vm.icon.caretRight,staticStyle:{\"width\":\"10px\"},on:{\"dblclick\":function($event){$event.stopPropagation();}}}),_c('i',{staticClass:\"me-2\",class:_vm.open ? _vm.icon.folderOpen : _vm.icon.folder,on:{\"click\":function($event){$event.stopPropagation();}}})]):_c('i',{staticClass:\"mx-2\",class:_vm.icon.fileAlt})]),_c('div',{staticClass:\"d-table-cell pe-1\"},[(!_vm.editItem)?_c('font',[_vm._v(\" \"+_vm._s(_vm.item.value)+\" \")]):_c('b-text',{ref:\"edior\",attrs:{\"value\":_vm.item.value,\"size\":\"sm\"},on:{\"blur\":_vm.editorBlur}})],1)]),(_vm.isFolder)?_c('b-tree',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.open),expression:\"open\"}],staticClass:\"mx-3\",attrs:{\"status\":_vm.status,\"list\":_vm.item.children,\"primar-key\":_vm.primaryKey},model:{value:(_vm.selectedOption),callback:function ($$v) {_vm.selectedOption=$$v},expression:\"selectedOption\"}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <div\r\n      ref=\"dropzone\"\r\n      class=\"d-table-row d-flex align-items-center\"\r\n      :class=\"objClass\"\r\n      draggable=\"true\"\r\n      @mouseenter=\"mouseenterOnItem\"\r\n      @mouseleave=\"mouseleaveOnItem\"\r\n      @click.stop=\"clickOnItem\"\r\n      @dblclick.stop=\"dblclickOnItem\"\r\n      @dragstart=\"dragstart\"\r\n      @dragover.prevent=\"dragover\"\r\n      @dragleave=\"dragleave\"\r\n      @dragend=\"dragend\"\r\n      @dragexit=\"dragexit\"\r\n      @drop.stop.prevent=\"drop\"\r\n    >\r\n      <div\r\n        class=\"d-table-cell ps-1\"\r\n        :class=\"itemClass\"\r\n        @click.stop=\"open = !open\"\r\n      >\r\n        <div v-if=\"isFolder\">\r\n          <i\r\n            class=\"me-2\"\r\n            :class=\"open ? icon.caretDown : icon.caretRight\"\r\n            style=\"width: 10px\"\r\n            @dblclick.stop\r\n          />\r\n          <i\r\n            class=\"me-2\"\r\n            :class=\"open ? icon.folderOpen : icon.folder\"\r\n            @click.stop\r\n          />\r\n        </div>\r\n        <i\r\n          v-else\r\n          class=\"mx-2\"\r\n          :class=\"icon.fileAlt\"\r\n        />\r\n      </div>\r\n      <!-- icon -->\r\n      <div class=\"d-table-cell pe-1\">\r\n        <font v-if=\"!editItem\">\r\n          {{ item.value }}\r\n        </font>\r\n        <b-text\r\n          v-else\r\n          ref=\"edior\"\r\n          :value=\"item.value\"\r\n          size=\"sm\"\r\n          @blur=\"editorBlur\"\r\n        />\r\n      </div>\r\n      <!-- label or edit -->\r\n    </div>\r\n    <!-- item -->\r\n    <b-tree\r\n      v-if=\"isFolder\"\r\n      v-show=\"open\"\r\n      v-model=\"selectedOption\"\r\n      class=\"mx-3\"\r\n      :status=\"status\"\r\n      :list=\"item.children\"\r\n      :primar-key=\"primaryKey\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport tools from \"@/tools/index.js\";\r\nimport config from \"@/config/index.js\";\r\nimport util from \"@/components/util/index.js\";\r\n\r\nimport BText from \"@/components/form/b-text.vue\";\r\n\r\n// drop\r\n// https://developer.mozilla.org/zh-CN/docs/Web/API/HTML_Drag_and_Drop_API\r\n// https://developer.mozilla.org/zh-CN/docs/Web/API/Document/drop_event\r\n\r\nexport default {\r\n  name: \"BTreeItem\",\r\n  components: { BTree: () => import(\"./b-tree\"), BText },\r\n  props: {\r\n    item: util.props.Object,\r\n    status: Number,\r\n    primaryKey: {\r\n      type: String,\r\n      default: \"id\",\r\n      require: true\r\n    },\r\n    selected: util.props.Object,\r\n  },\r\n  data() {\r\n    return {\r\n      open: this.item.open,\r\n      selectedOption: this.selected,\r\n      hover: false,\r\n      editItem: false, // 编辑\r\n      editError: false, // 编辑错误\r\n      dropStatus: \"default\" // 拖拽状态\r\n      // default: 默认, start: 开始, end: 结束, top: 上部, bottom: 下部\r\n    };\r\n  },\r\n  computed: {\r\n    icon: function() {\r\n      return config.ui.icon;\r\n    },\r\n    objClass: function() {\r\n      let disabled = !this.canEdit && !this.isSelected ? 'text-black-50' : ''\r\n      let isHover = this.hover\r\n        ? \"bg-light text-primary font-weight-bolder\"\r\n        : \"\";\r\n      let beChecked = this.isSelected ? \"text-light bg-primary\" : \"\";\r\n      return `${disabled} ${beChecked} ${isHover}`;\r\n    },\r\n    itemClass: function() {\r\n      let beChecked = this.isSelected ? \"\" : \"text-secondary\";\r\n      return `${beChecked} `;\r\n    },\r\n    isFolder: function() {\r\n      return this.item.children;\r\n    },\r\n    canEdit: function() {\r\n      return this.status == 1 && !this.item.disabled;\r\n    },\r\n    isSelected: function() {\r\n      return this.selectedOption &&\r\n        this.item[this.primaryKey] &&\r\n        this.selectedOption[this.primaryKey] &&\r\n        this.selectedOption[this.primaryKey] === this.item[this.primaryKey]\r\n    }\r\n  },\r\n  watch: {\r\n    selected: function(value) {\r\n      this.selectedOption = value;\r\n    },\r\n    selectedOption: function(value) {\r\n      this.$emit(\"item:selected\", value);\r\n    }\r\n  },\r\n  methods: {\r\n    mouseenterOnItem: function() {\r\n      if (!this.isSelected) this.hover = true;\r\n    },\r\n    mouseleaveOnItem: function() {\r\n      if (!this.isSelected) this.hover = false;\r\n    },\r\n    clickOnItem: function() {\r\n      this.hover = false;\r\n      this.selectedOption = this.item;\r\n    },\r\n    dblclickOnItem: async function() {\r\n      this.hover = false;\r\n      if (!this.canEdit) return;\r\n      this.editItem = true;\r\n      await this.$nextTick();\r\n      // 自动全选 editor 中的内容\r\n      await tools.document.setCursorPos(this.$refs.edior.$refs.text);\r\n    },\r\n    editValid: function() {\r\n      this.editError = false;\r\n    },\r\n    editInvalid: function() {\r\n      this.editError = true;\r\n    },\r\n    editorBlur: function() {\r\n      this.hideEditor();\r\n    },\r\n    hideEditor: function() {\r\n      if (this.editItem && !this.editError) this.editItem = false;\r\n    },\r\n    dragstart: function(event) {\r\n      event.target.style.opacity = \".5\";\r\n      event.dataTransfer.setData(\"text/plain\", null);\r\n      this.dropStatus = \"start\";\r\n    },\r\n    dragend: function(event) {\r\n      event.target.style.opacity = \"\";\r\n      this.dropStatus = \"end\";\r\n      if (this.$store.state.timer) this.$store.commit(\"stopTimer\");\r\n    },\r\n    dragexit: function() {\r\n      this.dropStatus = \"end\";\r\n      if (this.$store.state.timer) this.$store.commit(\"stopTimer\");\r\n    },\r\n    dragover: function(event) {\r\n      let target = this.$refs.dropzone;\r\n      if (this.isFolder) {\r\n        if (!this.$store.state.timer) {\r\n          tools.dom.addClass(target, \"bg-light\");\r\n          this.$store.commit(\"startTimer\", {\r\n            cellback: () => (this.open = true)\r\n          });\r\n        }\r\n      } else {\r\n        let currentTarget = event.currentTarget || undefined;\r\n        if (currentTarget)\r\n          this.dropStatus =\r\n            event.y - currentTarget.offsetTop < currentTarget.offsetHeight / 2\r\n              ? \"top\"\r\n              : \"bottom\";\r\n        tools.dom.addClass(target, \"border-primary\");\r\n        tools.dom.removeClass(target, `border-top`);\r\n        tools.dom.removeClass(target, `border-bottom`);\r\n        tools.dom.addClass(target, `border-${this.dropStatus}`);\r\n      }\r\n    },\r\n    dragleave: function() {\r\n      let target = this.$refs.dropzone;\r\n      tools.dom.removeClass(target, \"border-primary\");\r\n      tools.dom.removeClass(target, `border-top`);\r\n      tools.dom.removeClass(target, `border-bottom`);\r\n      tools.dom.removeClass(target, \"bg-light\");\r\n      if (this.isFolder && this.$store.state.timer)\r\n        this.$store.commit(\"stopTimer\");\r\n    },\r\n    drop: function(event) {\r\n      let target = this.$refs.dropzone;\r\n      tools.dom.removeClass(target, \"border-primary\");\r\n      tools.dom.removeClass(target, `border-top`);\r\n      tools.dom.removeClass(target, `border-bottom`);\r\n      tools.dom.removeClass(target, \"bg-light\");\r\n      this.dropStatus = \"default\";\r\n      if (this.isFolder && this.$store.state.timer)\r\n        this.$store.commit(\"stopTimer\");\r\n      this.$emit(\"item:drop\", event, this.isFolder, this.dropStatus);\r\n    }\r\n  }\r\n};\r\n</script>\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./b-tree-item.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./b-tree-item.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./b-tree-item.vue?vue&type=template&id=957cb214&\"\nimport script from \"./b-tree-item.vue?vue&type=script&lang=js&\"\nexport * from \"./b-tree-item.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}